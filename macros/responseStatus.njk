{% from "timeRemaining.njk" import timeRemaining %}

{% macro claimSettledStatus(url) %}
  <p>{{ t('You have signed the agreement. The claim is now settled.') }}</p>
  <p><a href="{{ url }}">{{ t('View agreement') }}</a></p>
{% endmacro %}

{% macro responseStatusForDefendant(claim, url, isAfter4pm) %}

  {% if claim.status === ClaimStatus.OFFER_SETTLEMENT_REACHED %}
    {{ claimSettledStatus(url) }}
  {% elseif claim.status === ClaimStatus.CCJ_REQUESTED %}
    {{ t('%s requested a County Court Judgment against you on %s. We will contact you both within 5 working days.',
    { postProcess: 'sprintf', sprintf: [ claim.claimData.claimant.name, claim.countyCourtJudgmentRequestedAt | date ]}) }}
  {% elseif claim.status === ClaimStatus.FREE_MEDIATION %}
    {{ t('You’ve rejected the claim and suggested mediation on %s. They need to respond within 5 working days.',
    { postProcess: 'sprintf', sprintf: [ claim.respondedAt | date ]}) }}
  {% elseif claim.status === ClaimStatus.CLAIM_REJECTED %}
    {{ t('You’ve has rejected the claim. The case will be reviewed by a judge and might go to court.' ) }}
  {% elseif claim.status === ClaimStatus.OFFER_SUBMITTED %}
    {{ t('You have made an offer to %s and must wait for their response.',
    { postProcess: 'sprintf', sprintf: [ claim.claimData.claimant.name ]}) }}
  {% else %}
    {{ t('<a href="%s">Respond to claim</a>', { postProcess: 'sprintf', sprintf: [ url ] }) | safe }}
    <span class="block mobile-inline">
      {{ timeRemaining(claim.remainingDays, isAfter4pm) }}
    </span>
  {% endif %}

{% endmacro %}

{% macro responseStatusForClaimant(claim, url) %}

  {% if claim.status === ClaimStatus.CCJ_REQUESTED %}
    {{ t('You requested a County Court Judgment on %s. We will contact you within 5 working days.',
    { postProcess: 'sprintf', sprintf: [ claim.countyCourtJudgmentRequestedAt | date ]}) }}
  {% elseif claim.status === ClaimStatus.ELIGIBLE_FOR_CCJ %}
    {{ t('Request a County Court Judgment.') }}
  {% elseif claim.status === ClaimStatus.OFFER_SETTLEMENT_REACHED %}
    {{ claimSettledStatus(url) }}
  {% elseif claim.status === ClaimStatus.FREE_MEDIATION %}
    {{ t('%s has rejected the claim. They’ve suggested free mediation on %s. You need to respond within 5 working days.',
    { postProcess: 'sprintf', sprintf: [ claim.response.defendant.name, claim.respondedAt | date ]}) }}
  {% elseif claim.status === ClaimStatus.CLAIM_REJECTED %}
    {{ t('%s has rejected the claim. The case will be reviewed by a judge and might go to court.',
    { postProcess: 'sprintf', sprintf: [ claim.claimData.defendant.name ]}) }}
  {% elseif claim.status === ClaimStatus.OFFER_SUBMITTED %}
    {{ t('%s wants to settle out of court. View <a href="%s">their offer</a>.',
    { postProcess: 'sprintf', sprintf: [ claim.claimData.defendant.name, url ] }) | safe }}
  {% elseif claim.status === ClaimStatus.MORE_TIME_REQUESTED %}
    {{ t('%s has requested an extra 14 days to respond. They need to respond by %s.',
    { postProcess: 'sprintf', sprintf: [ claim.claimData.defendant.name, claim.responseDeadline | date ]}) }}
  {% else %}
    {{ t('Your claim is being processed. We will email you to explain what to do next.') }}
  {% endif %}

{% endmacro %}
